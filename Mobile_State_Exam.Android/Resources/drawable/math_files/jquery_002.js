(function(n){n.extend(n.fn,{swapClass:function(n,t){var i=this.filter("."+n);return this.filter("."+t).removeClass(t).addClass(n),i.removeClass(n).addClass(t),this},replaceClass:function(n,t){return this.filter("."+n).removeClass(n).addClass(t).end()},hoverClass:function(t){return t=t||"hover",this.hover(function(){n(this).addClass(t)},function(){n(this).removeClass(t)})},heightToggle:function(n,t){n?this.animate({height:"toggle"},n,t):this.each(function(){jQuery(this)[jQuery(this).is(":hidden")?"show":"hide"](),t&&t.apply(this,arguments)})},heightHide:function(n,t){n?this.animate({height:"hide"},n,t):(this.hide(),t&&this.each(t))},prepareBranches:function(n){return n.prerendered||(this.filter(":last-child:not(ul)").addClass(t.last),this.filter((n.collapsed?"":"."+t.closed)+":not(."+t.open+")").find(">ul").hide()),this.filter(":has(>ul)")},applyClasses:function(i,r){this.filter(":has(>ul):not(:has(>a))").find(">span").click(function(){r.apply(n(this).next())}).add(n("a",this)).hoverClass(),i.prerendered||(this.filter(":has(>ul:hidden)").addClass(t.expandable).replaceClass(t.last,t.lastExpandable),this.not(":has(>ul:hidden)").addClass(t.collapsable).replaceClass(t.last,t.lastCollapsable),this.prepend('<div class="'+t.hitarea+'"/>').find("div."+t.hitarea).each(function(){var t="";n.each(n(this).parent().attr("class").split(" "),function(){t+=this+"-hitarea "}),n(this).addClass(t)})),this.find("div."+t.hitarea).click(r)},treeview:function(i){function h(i,r){function u(r){return function(){return e.apply(n("div."+t.hitarea,i).filter(function(){return r?n(this).parent("."+r).length:!0})),!1}}n("a:eq(0)",r).click(u(t.collapsable)),n("a:eq(1)",r).click(u(t.expandable)),n("a:eq(2)",r).click(u())}function e(){n(this).parent().find(">.hitarea").swapClass(t.collapsableHitarea,t.expandableHitarea).swapClass(t.lastCollapsableHitarea,t.lastExpandableHitarea).end().swapClass(t.collapsable,t.expandable).swapClass(t.lastCollapsable,t.lastExpandable).find(">ul").heightToggle(i.animated,i.toggle),i.unique&&n(this).parent().siblings().find(">.hitarea").replaceClass(t.collapsableHitarea,t.expandableHitarea).replaceClass(t.lastCollapsableHitarea,t.lastExpandableHitarea).end().replaceClass(t.collapsable,t.expandable).replaceClass(t.lastCollapsable,t.lastExpandable).find(">ul").heightHide(i.animated,i.toggle)}function s(){var t=[];u.each(function(i,r){t[i]=n(r).is(":has(>ul:visible)")?1:0}),n.cookie(i.cookieId,t.join(""))}function c(){var r=n.cookie(i.cookieId),t;r&&(t=r.split(""),u.each(function(i,r){n(r).find(">ul")[parseInt(t[i])?"show":"hide"]()}))}var o,u,f,r;if(i=n.extend({cookieId:"treeview"},i),i.add)return this.trigger("add",[i.add]);i.toggle&&(o=i.toggle,i.toggle=function(){return o.apply(n(this).parent()[0],arguments)}),this.addClass("treeview"),u=this.find("li").prepareBranches(i);switch(i.persist){case"cookie":f=i.toggle,i.toggle=function(){s(),f&&f.apply(this,arguments)},c();break;case"location":r=this.find("a").filter(function(){return this.href.toLowerCase()==location.href.toLowerCase()}),r.length&&r.addClass("selected").parents("ul, li").add(r.next()).show()}return u.applyClasses(i,e),i.control&&(h(this,i.control),n(i.control).show()),this.bind("add",function(r,u){n(u).prev().removeClass(t.last).removeClass(t.lastCollapsable).removeClass(t.lastExpandable).find(">.hitarea").removeClass(t.lastCollapsableHitarea).removeClass(t.lastExpandableHitarea),n(u).find("li").andSelf().prepareBranches(i).applyClasses(i,e)})}});var t=n.fn.treeview.classes={open:"open",closed:"closed",expandable:"expandable",expandableHitarea:"expandable-hitarea",lastExpandableHitarea:"lastExpandable-hitarea",collapsable:"collapsable",collapsableHitarea:"collapsable-hitarea",lastCollapsableHitarea:"lastCollapsable-hitarea",lastCollapsable:"lastCollapsable",lastExpandable:"lastExpandable",last:"last",hitarea:"hitarea"};n.fn.Treeview=n.fn.treeview})(jQuery)